# Excel处理学习路线规划

> 使用Cursor协助处理日常工作中Excel文件的完整学习路线

## 📋 目录

1. [学习路线概览](#学习路线概览)
2. [Python基础知识要求](#python基础知识要求)
3. [Excel处理库学习顺序](#excel处理库学习顺序)
4. [实战应用场景](#实战应用场景)
5. [学习资源索引](#学习资源索引)
6. [快速查询指南](#快速查询指南)

---

## 🎯 学习路线概览

### 阶段一：Python基础（必须掌握）
**目标**：掌握处理Excel所需的基础Python知识

**学习内容**：
- 变量与数据类型（列表、字典、字符串）
- 循环语句（for循环、while循环）
- 函数定义与调用
- 文件操作基础
- 异常处理

**预计时间**：1-2周

**学习文件**：
- `Python基础学习/Python变量与数据类型学习.ipynb`
- `Python基础学习/Python循环语句学习指南.ipynb`
- `Python基础学习/Python循环与函数学习指南.ipynb`
- `Python基础学习/Python文件操作学习指南.ipynb`
- `Python基础学习/Python异常与错误处理学习.ipynb`

### 阶段二：Excel处理库入门（核心技能）
**目标**：掌握最常用的Excel处理库

**学习内容**：
1. **Pandas** - 数据分析与Excel读写
2. **OpenPyXL** - 精确控制Excel格式
3. **XlsxWriter** - 高效创建Excel文件

**预计时间**：2-3周

**学习文件**：
- `pandas学习教程.ipynb`
- `openpyxl学习指南.ipynb`
- `xlsxwriter学习指南.ipynb`

### 阶段三：高级应用（提升效率）
**目标**：解决复杂业务场景

**学习内容**：
- 批量处理多个Excel文件
- 数据清洗与转换
- 自动化报表生成
- 模板填充
- 数据合并与拆分

**预计时间**：1-2周

### 阶段四：实战项目（巩固应用）
**目标**：独立完成实际工作需求

**学习内容**：
- 综合项目练习
- 性能优化
- 错误处理
- 代码复用

**预计时间**：持续实践

---

## 📚 Python基础知识要求

### 1. 变量与数据类型（⭐⭐⭐⭐⭐ 必须掌握）

#### 核心知识点：
- **列表（List）**：存储Excel行数据
  ```python
  data = ['张三', 25, '北京', 8000]  # 一行Excel数据
  ```
- **字典（Dict）**：存储Excel列数据
  ```python
  data = {'姓名': '张三', '年龄': 25, '城市': '北京'}  # 一列Excel数据
  ```
- **字符串（String）**：处理Excel中的文本
  ```python
  filename = '销售报表.xlsx'
  sheet_name = '1月数据'
  ```
- **数字类型**：处理Excel中的数值
  ```python
  sales = 50000  # int
  price = 99.99  # float
  ```

**学习文件**：`Python基础学习/Python变量与数据类型学习.ipynb`

### 2. 循环语句（⭐⭐⭐⭐⭐ 必须掌握）

#### 核心知识点：
- **for循环**：遍历Excel行/列
  ```python
  # 遍历Excel的每一行
  for row in excel_data:
      print(row)
  
  # 遍历Excel的每一列
  for col_name in excel_data.columns:
      print(col_name)
  ```
- **列表推导式**：快速处理数据
  ```python
  # 筛选大于1000的销售额
  high_sales = [x for x in sales_list if x > 1000]
  ```

**学习文件**：
- `Python基础学习/Python循环语句学习指南.ipynb`
- `Python基础学习/Python循环与函数学习指南.ipynb`

### 3. 函数定义（⭐⭐⭐⭐ 重要）

#### 核心知识点：
- **函数定义**：封装Excel处理逻辑
  ```python
  def read_excel_file(filename):
      """读取Excel文件"""
      df = pd.read_excel(filename)
      return df
  
  def format_excel_cell(cell, style):
      """格式化Excel单元格"""
      cell.font = Font(bold=True)
      return cell
  ```
- **参数传递**：灵活处理不同文件
- **返回值**：返回处理后的数据

**学习文件**：`Python基础学习/Python循环与函数学习指南.ipynb`

### 4. 文件操作（⭐⭐⭐⭐ 重要）

#### 核心知识点：
- **文件路径处理**：使用`os`模块
  ```python
  import os
  file_path = os.path.join('data', 'sales.xlsx')
  ```
- **文件存在性检查**：避免错误
  ```python
  if os.path.exists('file.xlsx'):
      # 处理文件
  ```

**学习文件**：
- `Python基础学习/Python文件操作学习指南.ipynb`
- `Python_os标准库学习.ipynb`

### 5. 异常处理（⭐⭐⭐ 推荐）

#### 核心知识点：
- **try-except**：处理文件读取错误
  ```python
  try:
      df = pd.read_excel('file.xlsx')
  except FileNotFoundError:
      print("文件不存在")
  except Exception as e:
      print(f"发生错误：{e}")
  ```

**学习文件**：`Python基础学习/Python异常与错误处理学习.ipynb`

### 6. 字符串处理（⭐⭐⭐ 推荐）

#### 核心知识点：
- **字符串格式化**：生成文件名
  ```python
  filename = f'报表_{year}年{month}月.xlsx'
  ```
- **字符串方法**：清洗数据
  ```python
  text = '  Excel数据  '
  cleaned = text.strip()  # 去除空格
  ```

**学习文件**：`Python_re模块学习.ipynb`（正则表达式）

---

## 📖 Excel处理库学习顺序

### 第一步：Pandas（⭐⭐⭐⭐⭐ 优先学习）

**为什么先学Pandas？**
- 最简单易学
- 最适合数据分析
- 读写Excel最常用
- 数据处理功能强大

**核心功能**：
- `pd.read_excel()` - 读取Excel
- `df.to_excel()` - 写入Excel
- 数据清洗、筛选、分组、合并

**适用场景**：
- 读取Excel进行数据分析
- 数据清洗后导出Excel
- 简单的Excel读写操作

**学习文件**：`pandas学习教程.ipynb`

**学习重点**：
1. DataFrame的创建和操作
2. 数据读取与写入
3. 数据筛选与选择
4. 数据清洗（缺失值、重复值）
5. 数据分组与聚合
6. 数据合并

### 第二步：OpenPyXL（⭐⭐⭐⭐ 精确控制）

**为什么学OpenPyXL？**
- 可以读写Excel文件
- 精确控制格式（字体、颜色、边框）
- 支持公式、图表
- 适合需要格式化的场景

**核心功能**：
- `load_workbook()` - 读取Excel
- `Workbook()` - 创建Excel
- 单元格样式设置
- 公式和图表

**适用场景**：
- 需要精确控制Excel格式
- 批量生成格式化的报表
- 修改现有Excel文件
- 需要设置公式和图表

**学习文件**：`openpyxl学习指南.ipynb`

**学习重点**：
1. 创建工作簿和工作表
2. 读写单元格数据
3. 样式设置（字体、颜色、边框）
4. 公式设置
5. 批量操作
6. 图表创建

### 第三步：XlsxWriter（⭐⭐⭐ 高效创建）

**为什么学XlsxWriter？**
- 专门用于创建Excel（不支持读取）
- 性能极佳，适合大数据量
- 格式化功能强大
- 适合批量生成报表

**核心功能**：
- `Workbook()` - 创建Excel
- 格式化对象（Format）
- 公式和图表
- 条件格式

**适用场景**：
- 批量生成Excel报表
- 需要高性能的场景
- 只需要创建，不需要读取
- 复杂的格式化需求

**学习文件**：`xlsxwriter学习指南.ipynb`

**学习重点**：
1. 创建工作簿和工作表
2. 格式化对象的使用
3. 批量写入数据
4. 公式和图表
5. 条件格式

---

## 🎯 实战应用场景

### 场景1：读取Excel进行数据分析

**使用库**：Pandas

**典型任务**：
- 读取销售数据Excel
- 计算总销售额、平均值
- 按部门/产品分组统计
- 导出分析结果

**代码示例**：
```python
import pandas as pd

# 读取Excel
df = pd.read_excel('销售数据.xlsx')

# 数据分析
total_sales = df['销售额'].sum()
avg_sales = df['销售额'].mean()
dept_summary = df.groupby('部门')['销售额'].sum()

# 导出结果
dept_summary.to_excel('分析结果.xlsx')
```

**学习路径**：
1. 学习Pandas基础 → `pandas学习教程.ipynb`
2. 学习数据分组 → `pandas学习教程.ipynb` 第9节
3. 学习数据导出 → `pandas学习教程.ipynb` 第4节

### 场景2：批量生成格式化的报表

**使用库**：OpenPyXL 或 XlsxWriter

**典型任务**：
- 为每个部门生成独立报表
- 设置统一的格式（表头、颜色、边框）
- 添加公式计算总计
- 创建图表

**代码示例**：
```python
from openpyxl import Workbook
from openpyxl.styles import Font, PatternFill

# 创建报表
wb = Workbook()
ws = wb.active

# 设置格式
header_fill = PatternFill(start_color="4472C4", end_color="4472C4", fill_type="solid")
header_font = Font(bold=True, color="FFFFFF")

# 批量生成
for dept in departments:
    # 创建部门报表
    create_dept_report(dept, wb)
```

**学习路径**：
1. 学习OpenPyXL基础 → `openpyxl学习指南.ipynb`
2. 学习样式设置 → `openpyxl学习指南.ipynb` 第5节
3. 学习批量操作 → `openpyxl学习指南.ipynb` 第7节

### 场景3：数据清洗后导出

**使用库**：Pandas + OpenPyXL/XlsxWriter

**典型任务**：
- 读取原始Excel数据
- 清洗数据（去重、填充缺失值、修正错误）
- 格式化后导出

**代码示例**：
```python
import pandas as pd
from openpyxl import load_workbook

# 用Pandas读取和清洗
df = pd.read_excel('原始数据.xlsx')
df = df.drop_duplicates()  # 去重
df = df.fillna(0)  # 填充缺失值

# 导出为Excel
df.to_excel('清洗后数据.xlsx', index=False)

# 用OpenPyXL格式化
wb = load_workbook('清洗后数据.xlsx')
ws = wb.active
# 设置格式...
wb.save('最终报表.xlsx')
```

**学习路径**：
1. 学习Pandas数据清洗 → `pandas学习教程.ipynb` 第7节
2. 学习OpenPyXL格式化 → `openpyxl学习指南.ipynb` 第5节

### 场景4：合并多个Excel文件

**使用库**：Pandas 或 OpenPyXL

**典型任务**：
- 读取多个部门的Excel文件
- 合并到一个总表
- 添加数据来源标识

**代码示例**：
```python
import pandas as pd
import os

# 读取多个文件
files = ['部门1.xlsx', '部门2.xlsx', '部门3.xlsx']
all_data = []

for file in files:
    df = pd.read_excel(file)
    df['数据来源'] = file  # 添加标识
    all_data.append(df)

# 合并
merged_df = pd.concat(all_data, ignore_index=True)
merged_df.to_excel('合并数据.xlsx', index=False)
```

**学习路径**：
1. 学习Pandas数据合并 → `pandas学习教程.ipynb` 第10节
2. 学习文件操作 → `Python基础学习/Python文件操作学习指南.ipynb`

### 场景5：基于模板填充数据

**使用库**：OpenPyXL

**典型任务**：
- 读取Excel模板
- 填充不同数据
- 生成多个文件

**代码示例**：
```python
from openpyxl import load_workbook

def fill_template(template_file, data, output_file):
    wb = load_workbook(template_file)
    ws = wb.active
    
    # 填充数据
    ws['B3'] = data['姓名']
    ws['B4'] = data['部门']
    ws['B5'] = data['薪资']
    
    wb.save(output_file)

# 批量填充
for employee in employees:
    fill_template('模板.xlsx', employee, f'员工_{employee["姓名"]}.xlsx')
```

**学习路径**：
1. 学习OpenPyXL读写 → `openpyxl学习指南.ipynb` 第3-4节
2. 学习函数封装 → `Python基础学习/Python循环与函数学习指南.ipynb`

---

## 📚 学习资源索引

### Python基础学习文件

| 知识点 | 文件路径 | 重要性 |
|--------|---------|--------|
| 变量与数据类型 | `Python基础学习/Python变量与数据类型学习.ipynb` | ⭐⭐⭐⭐⭐ |
| 循环语句 | `Python基础学习/Python循环语句学习指南.ipynb` | ⭐⭐⭐⭐⭐ |
| 函数 | `Python基础学习/Python循环与函数学习指南.ipynb` | ⭐⭐⭐⭐ |
| 文件操作 | `Python基础学习/Python文件操作学习指南.ipynb` | ⭐⭐⭐⭐ |
| 异常处理 | `Python基础学习/Python异常与错误处理学习.ipynb` | ⭐⭐⭐ |
| 字符串处理 | `Python_re模块学习.ipynb` | ⭐⭐⭐ |
| OS模块 | `Python_os标准库学习.ipynb` | ⭐⭐⭐ |

### Excel处理库学习文件

| 库名 | 文件路径 | 适用场景 | 优先级 |
|------|---------|---------|--------|
| Pandas | `pandas学习教程.ipynb` | 数据分析、简单读写 | ⭐⭐⭐⭐⭐ |
| OpenPyXL | `openpyxl学习指南.ipynb` | 精确控制、格式化 | ⭐⭐⭐⭐ |
| XlsxWriter | `xlsxwriter学习指南.ipynb` | 高效创建、批量生成 | ⭐⭐⭐ |

### 其他相关学习文件

| 主题 | 文件路径 | 说明 |
|------|---------|------|
| 数据可视化 | `matplotlib学习指南.ipynb` | 可结合Excel数据绘图 |
| 数据可视化 | `seaborn学习指南.ipynb` | 高级数据可视化 |
| 数据可视化 | `Plotly学习指南.ipynb` | 交互式图表 |
| 数据库 | `duckDB学习指南.ipynb` | 可结合Excel数据处理 |

---

## 🔍 快速查询指南

### 按任务查找解决方案

#### 任务：读取Excel文件
- **简单读取** → Pandas: `pd.read_excel('file.xlsx')`
- **需要格式信息** → OpenPyXL: `load_workbook('file.xlsx')`
- **参考文件**：`pandas学习教程.ipynb` 第4节，`openpyxl学习指南.ipynb` 第4节

#### 任务：写入Excel文件
- **简单写入** → Pandas: `df.to_excel('file.xlsx')`
- **需要格式化** → OpenPyXL: `wb.save('file.xlsx')`
- **批量创建** → XlsxWriter: `workbook.close()`
- **参考文件**：`pandas学习教程.ipynb` 第4节，`openpyxl学习指南.ipynb` 第3节，`xlsxwriter学习指南.ipynb` 第2节

#### 任务：设置单元格格式
- **字体、颜色** → OpenPyXL: `cell.font = Font(bold=True)`
- **格式化对象** → XlsxWriter: `format = workbook.add_format({'bold': True})`
- **参考文件**：`openpyxl学习指南.ipynb` 第5节，`xlsxwriter学习指南.ipynb` 第3节

#### 任务：批量处理多个文件
- **循环处理** → 使用for循环 + 文件操作
- **参考文件**：`Python基础学习/Python循环语句学习指南.ipynb`，`openpyxl学习指南.ipynb` 第7节

#### 任务：数据清洗
- **去重、填充** → Pandas: `df.drop_duplicates()`, `df.fillna()`
- **参考文件**：`pandas学习教程.ipynb` 第7节

#### 任务：数据分组统计
- **分组聚合** → Pandas: `df.groupby().sum()`
- **参考文件**：`pandas学习教程.ipynb` 第9节

#### 任务：合并多个Excel
- **数据合并** → Pandas: `pd.concat()` 或 `pd.merge()`
- **参考文件**：`pandas学习教程.ipynb` 第10节

#### 任务：创建图表
- **图表创建** → OpenPyXL: `add_chart()` 或 XlsxWriter: `add_chart()`
- **参考文件**：`openpyxl学习指南.ipynb` 第8节，`xlsxwriter学习指南.ipynb` 第4节

### 按库查找功能
