# Cursor Pro 使用指南

## 目录
1. [Cursor 核心功能概览](#cursor-核心功能概览)
2. [针对您的三大使用场景](#针对您的三大使用场景)
3. [模型推荐与额度优化](#模型推荐与额度优化)
4. [使用技巧与最佳实践](#使用技巧与最佳实践)
5. [文件处理限制与注意事项](#文件处理限制与注意事项)
6. [Excel 处理专用指南](#excel-处理专用指南)

---

## Cursor 核心功能概览

### 1. AI 代码助手功能

#### **Chat 功能（Ctrl+L / Cmd+L）**
- **用途**：与 AI 进行对话，询问代码问题、获取解释、生成代码
- **特点**：
  - 支持上下文理解（能看到当前打开的文件）
  - 可以引用代码片段进行讨论
  - 支持多轮对话

#### **Composer 功能（Ctrl+I / Cmd+I）**
- **用途**：多文件编辑，处理复杂任务
- **特点**：
  - 可以同时编辑多个文件
  - 适合重构、大型功能开发
  - 支持项目级别的代码生成

#### **Inline Edit（Tab 键）**
- **用途**：接受 AI 建议的代码补全
- **特点**：
  - 自动代码补全
  - 基于上下文的智能建议
  - 快速提高编码效率

#### **Cmd/Ctrl+K（行内编辑）**
- **用途**：在光标位置直接编辑代码
- **特点**：
  - 快速修改单行或小段代码
  - 无需打开 Chat 窗口
如何打开markdown文件
### 2. 代码理解功能

- **代码高亮与跳转**：支持定义跳转、引用查找
- **错误检测**：实时显示语法错误和警告
- **代码格式化**：自动格式化代码

### 3. 文件管理功能

- **智能文件搜索**：快速定位文件
- **多标签页管理**：同时打开多个文件
- **Git 集成**：版本控制可视化

---

## 针对您的三大使用场景

### 场景一：生成较长的 Jupyter 学习文件

#### **推荐方法：使用 Composer（Ctrl+I）**

**操作步骤：**
1. 打开或创建 `.ipynb` 文件
2. 按 `Ctrl+I`（Windows）或 `Cmd+I`（Mac）打开 Composer
3. 输入详细的需求描述，例如：
   ```
   请为我创建一个完整的 pandas 数据处理学习指南，包括：
   - 数据读取（CSV、Excel、JSON）
   - 数据清洗（缺失值、重复值、异常值）
   - 数据筛选与分组
   - 数据聚合与统计
   - 数据可视化基础
   每个部分都要有详细的代码示例和注释
   ```
4. Composer 会自动生成完整的 Jupyter Notebook 内容

**优势：**
- 可以一次性生成大量内容
- 支持多单元格编辑
- 生成的代码结构清晰

**提示：**
- 如果内容太长，可以分章节生成
- 使用 `@文件名` 引用现有文件，让 AI 了解您的代码风格
- 生成后可以要求 AI 补充或修改特定部分

---

### 场景二：解释代码片段

#### **推荐方法：使用 Chat（Ctrl+L）**

**操作方式：**

**方法 1：选中代码后提问**
1. 选中需要解释的代码（可以是一行或多行）
2. 按 `Ctrl+L` 打开 Chat
3. 直接输入："请解释这段代码" 或 "这段代码的作用是什么？"
4. AI 会自动引用选中的代码进行解释

**方法 2：使用 @ 符号引用**
1. 按 `Ctrl+L` 打开 Chat
2. 输入 `@文件名` 引用特定文件 
3. 然后提问："请解释第 15-20 行的代码"

**方法 3：行内编辑（Cmd/Ctrl+K）**
1. 将光标放在需要解释的代码行
2. 按 `Ctrl+K`（Windows）或 `Cmd+K`（Mac）
3. 输入："解释这段代码" 或 "优化这段代码"

**示例对话：**
```
您：请解释这段 pandas 代码的作用
[选中代码]
AI：[详细解释代码功能、参数含义、返回值等]
```

---

### 场景三：Excel 表格处理（最重要）

#### **推荐工作流程**

**第一步：准备需求描述**
在 Chat 或 Composer 中，详细描述您的 Excel 处理需求：

```
我需要处理一个 Excel 文件，要求：
1. 读取 "销售数据.xlsx" 文件
2. 筛选出 2024 年的数据
3. 按产品类别分组统计销售额
4. 计算每个类别的增长率
5. 将结果保存到新的 Excel 文件 "统计结果.xlsx"
6. 使用 openpyxl 或 pandas 库
```

**第二步：选择合适的工具**

**对于简单操作（单文件、少量数据）：**
- 使用 **Chat（Ctrl+L）** 快速生成代码
- 适合：数据筛选、简单计算、格式调整

**对于复杂操作（多文件、大量数据处理）：**
- 使用 **Composer（Ctrl+I）** 生成完整脚本
- 适合：批量处理、复杂逻辑、多步骤操作

**第三步：代码执行与调试**

1. **在 Jupyter Notebook 中执行**
   - 将生成的代码复制到 Notebook 单元格
   - 逐步执行并查看结果
   - 遇到错误时，选中错误代码，在 Chat 中询问

2. **创建独立的 Python 脚本**
   - 对于重复性工作，建议创建 `.py` 脚本
   - 使用 Composer 生成完整的脚本框架

**常用 Excel 处理场景的提示词模板：**

```
# 数据读取与预览
"使用 pandas 读取 Excel 文件，显示前 5 行和基本信息"

# 数据清洗
"清理 Excel 数据：删除空行、处理缺失值、统一日期格式"

# 数据筛选
"从 Excel 中筛选满足条件的行，例如：销售额 > 10000 且日期在 2024 年"

# 数据分组统计
"按指定列分组，计算平均值、总和、计数等统计信息"

# 数据合并
"合并多个 Excel 文件，按行或列合并"

# 数据透视表
"创建数据透视表，按行和列分组统计"

# 格式调整
"使用 openpyxl 调整 Excel 格式：设置列宽、添加边框、设置字体颜色"

# 批量处理
"批量处理文件夹中的所有 Excel 文件，执行相同的数据处理操作"
```

---

## 模型推荐与额度优化

### Cursor Pro 可用模型

Cursor Pro 提供多种 AI 模型，不同模型有不同的特点和额度限制：

#### **1. Claude Sonnet 4.5（推荐用于复杂任务）**
- **特点**：
  - 代码理解能力强
  - 适合生成长文档和复杂逻辑
  - 上下文理解优秀
- **推荐场景**：
  - ✅ 生成较长的 Jupyter 学习文件
  - ✅ 复杂的 Excel 处理逻辑
  - ✅ 需要深度理解的代码解释
- **额度**：通常有较高的月度额度

#### **2. GPT-4 Turbo（推荐用于快速响应）**
- **特点**：
  - 响应速度快
  - 代码生成效率高
  - 适合迭代式开发
- **推荐场景**：
  - ✅ 快速代码补全
  - ✅ 简单代码解释
  - ✅ 日常 Excel 操作
- **额度**：通常有较高的请求次数

#### **3. Claude Opus（推荐用于高质量代码）**
- **特点**：
  - 代码质量最高
  - 适合生产环境代码
  - 理解复杂需求能力强
- **推荐场景**：
  - ✅ 重要的 Excel 处理脚本
  - ✅ 需要高质量代码的场景
- **额度**：可能有限制，谨慎使用

#### **4. GPT-3.5 Turbo（推荐用于简单任务）**
- **特点**：
  - 速度快、成本低
  - 适合简单问题
- **推荐场景**：
  - ✅ 简单的代码补全
  - ✅ 基础语法问题
- **额度**：通常最充足

### 额度优化策略

#### **策略 1：根据任务复杂度选择模型**

```
简单任务（代码解释、简单补全）
  → 使用 GPT-3.5 Turbo 或 GPT-4 Turbo
  → 节省额度，快速响应

中等任务（生成学习文件、常规 Excel 处理）
  → 使用 Claude Sonnet 4.5 或 GPT-4 Turbo
  → 平衡质量和额度

复杂任务（复杂 Excel 处理、大型代码生成）
  → 使用 Claude Sonnet 4.5 或 Claude Opus
  → 确保代码质量
```

#### **策略 2：合理使用上下文**

- **避免打开过多文件**：只打开当前需要的文件，减少上下文大小
- **使用 @ 符号精确引用**：只引用需要的文件，而不是让 AI 读取整个项目
- **分步骤处理**：对于长任务，分步骤完成，每次只处理一部分

#### **策略 3：复用代码模板**

- 创建常用代码模板文件
- 使用 `@模板文件` 引用，让 AI 基于模板生成
- 减少重复生成，节省额度

#### **策略 4：利用代码补全而非完整生成**

- 对于简单代码，使用 Tab 键接受补全建议
- 只在必要时使用 Chat 或 Composer
- 代码补全通常不消耗 Chat 额度

#### **策略 5：批量处理任务**

- 将多个相似任务合并为一个请求
- 例如："生成 5 个不同的 Excel 数据处理函数"
- 比分别请求 5 次更节省额度

### 模型切换方法

1. **在 Chat 中切换**：
   - 打开 Chat 窗口
   - 点击模型选择器（通常在输入框上方）
   - 选择所需模型

2. **设置默认模型**：
   - 打开设置（Ctrl+,）
   - 搜索 "model" 或 "AI"
   - 设置默认使用的模型

---

## 使用技巧与最佳实践

### 1. 高效提示词编写技巧

#### **明确具体**
❌ 不好："处理 Excel 文件"
✅ 好："使用 pandas 读取 'data.xlsx'，筛选出 '销售额' 列大于 10000 的行，按 '日期' 列排序，保存到 'result.xlsx'"

#### **提供上下文**
- 使用 `@文件名` 引用相关文件
- 说明数据格式和预期结果
- 提供示例数据或错误信息

#### **分步骤描述复杂任务**
```
第一步：读取 Excel 文件
第二步：数据清洗
第三步：数据计算
第四步：保存结果
```

#### **指定技术栈**
- 明确使用的库（pandas、openpyxl、xlsxwriter 等）
- 指定 Python 版本要求（如需要）
- 说明代码风格偏好

### 2. 快捷键速查

| 功能 | Windows | Mac |
|------|---------|-----|
| 打开 Chat | `Ctrl+L` | `Cmd+L` |
| 打开 Composer | `Ctrl+I` | `Cmd+I` |
| 行内编辑 | `Ctrl+K` | `Cmd+K` |
| 接受补全 | `Tab` | `Tab` |
| 拒绝补全 | `Esc` | `Esc` |
| 打开命令面板 | `Ctrl+Shift+P` | `Cmd+Shift+P` |
| 快速打开文件 | `Ctrl+P` | `Cmd+P` |

### 3. 代码引用技巧

#### **引用当前文件**
```
@当前文件 请优化这段代码
```

#### **引用特定行**
```
@文件名:15:20 请解释这段代码
```

#### **引用多个文件**
```
@文件1 @文件2 请比较这两个文件的差异
```

#### **引用文件夹**
```
@文件夹名/ 请分析这个文件夹中的所有 Python 文件
```

### 4. 错误处理技巧

**遇到错误时：**
1. 选中错误代码
2. 复制错误信息
3. 在 Chat 中描述："这段代码报错了：[粘贴错误信息]，请帮我修复"
4. AI 会分析错误并提供解决方案

### 5. 代码优化技巧

**请求优化时，明确需求：**
- "优化性能"：关注执行速度
- "优化可读性"：关注代码清晰度
- "优化内存使用"：关注资源消耗
- "添加错误处理"：增强代码健壮性

### 6. 学习文件生成技巧

**生成完整学习文件时：**
1. 先列出大纲，让 AI 生成目录结构
2. 分章节生成，每章单独请求
3. 要求添加实际案例和练习
4. 要求代码包含详细注释

**示例提示词：**
```
请为我生成一个完整的 pandas 学习指南，要求：
1. 包含目录结构
2. 每个知识点都有代码示例
3. 代码要有详细的中文注释
4. 包含实际案例（如：处理销售数据）
5. 每章末尾有练习题
```

---

## 文件处理限制与注意事项

### 1. 文件大小限制

#### **单个文件大小**
- **建议**：单个文件不超过 1MB
- **限制**：超过 5MB 的文件可能无法完整读取
- **解决方案**：
  - 大文件拆分成多个小文件
  - 只引用需要的部分（使用行号范围）
  - 使用 `@文件名:起始行:结束行` 精确引用

#### **项目总大小**
- Cursor 可以处理大型项目，但上下文有限
- 建议：只打开当前需要的文件
- 使用 `.cursorignore` 文件排除不需要的文件

### 2. 文件类型支持

#### **完全支持**
- ✅ Python 文件（.py）
- ✅ Jupyter Notebook（.ipynb）
- ✅ Markdown（.md）
- ✅ JSON、XML、CSV
- ✅ 配置文件（.json, .yaml, .toml 等）

#### **部分支持**
- ⚠️ 二进制文件（图片、视频等）：无法直接读取内容
- ⚠️ 大型数据库文件：建议导出为 CSV 或 JSON

#### **Excel 文件处理**
- ✅ 可以生成处理 Excel 的代码
- ⚠️ 不能直接读取 Excel 文件内容（需要通过代码）
- ✅ 建议：先描述 Excel 结构，让 AI 生成相应代码

### 3. 上下文窗口限制

#### **上下文大小**
- 不同模型有不同的上下文窗口大小
- Claude Sonnet 4.5：通常 200K tokens
- GPT-4 Turbo：通常 128K tokens

#### **优化建议**
1. **只打开需要的文件**：关闭不相关的标签页
2. **使用精确引用**：`@文件名:行号` 而不是引用整个文件
3. **清理对话历史**：长对话会占用上下文，适时清理
4. **分步骤处理**：大任务拆分成小步骤

### 4. 代码生成限制

#### **一次性生成代码量**
- 建议：单次生成不超过 500 行代码
- 对于长文件：分章节生成，然后合并

#### **复杂逻辑处理**
- 非常复杂的逻辑可能需要多次迭代
- 建议：先生成框架，再逐步完善

### 5. 网络与 API 限制

#### **网络要求**
- 需要稳定的网络连接
- 某些模型可能需要访问特定 API

#### **API 速率限制**
- 不同模型有不同的速率限制
- 如果遇到限制，稍等片刻再试
- 考虑切换到其他模型

### 6. 隐私与安全

#### **代码隐私**
- Cursor 会发送代码到 AI 服务进行处理
- 敏感代码建议：
  - 使用本地模型（如果支持）
  - 移除敏感信息后再提问
  - 使用代码片段而非完整文件

#### **数据安全**
- Excel 文件中的敏感数据：
  - 使用示例数据提问
  - 生成代码后本地执行
  - 不要直接上传包含敏感信息的文件

### 7. 性能优化建议

#### **提高响应速度**
1. 使用更快的模型（GPT-4 Turbo 通常比 Claude 快）
2. 减少上下文大小
3. 使用代码补全而非完整生成

#### **提高代码质量**
1. 提供详细的上下文
2. 使用高质量模型（Claude Opus）
3. 分步骤迭代优化

---

## Excel 处理专用指南

### 常用库对比

#### **1. pandas（推荐用于数据处理）**
- **优势**：
  - 强大的数据处理能力
  - 支持复杂的数据操作
  - 读写 Excel 简单
- **适用场景**：
  - 数据清洗、筛选、分组
  - 数据统计分析
  - 数据合并、透视
- **示例提示词**：
  ```
  使用 pandas 读取 Excel 文件，进行数据清洗和统计分析
  ```

#### **2. openpyxl（推荐用于格式控制）**
- **优势**：
  - 精确控制 Excel 格式
  - 支持公式、图表
  - 可以修改现有文件
- **适用场景**：
  - 设置单元格格式（颜色、字体、边框）
  - 调整列宽、行高
  - 添加图表、公式
- **示例提示词**：
  ```
  使用 openpyxl 创建一个格式化的 Excel 报告，包含标题、数据表格和图表
  ```
